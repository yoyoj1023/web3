# React useEffect ä¾è³´æ€§æ•™å­¸

## ğŸ“š å­¸ç¿’ç›®æ¨™

æœ¬ç¯„ä¾‹å°‡å¹«åŠ©æ‚¨ç†è§£ï¼š
- ä»€éº¼æ˜¯ React Effects
- å¦‚ä½•æŒ‡å®š Effect çš„ä¾è³´æ€§ (Dependencies)
- Effect ä½•æ™‚æœƒåŸ·è¡Œå’Œé‡æ–°åŸ·è¡Œ
- å¦‚ä½•é¿å…ä¸å¿…è¦çš„ Effect é‡æ–°åŸ·è¡Œ

## ğŸ” ä»€éº¼æ˜¯ Effectsï¼Ÿ

**Effect** è®“æ‚¨å¯ä»¥åœ¨æ¸²æŸ“å®Œæˆå¾ŒåŸ·è¡Œå‰¯ä½œç”¨ï¼ˆside effectsï¼‰ï¼Œç”¨ä¾†ï¼š
- èˆ‡å¤–éƒ¨ç³»çµ±åŒæ­¥ï¼ˆAPI å‘¼å«ã€DOM æ“ä½œç­‰ï¼‰
- è™•ç†ä¸å±¬æ–¼ç´”å‡½æ•¸è¨ˆç®—çš„æ“ä½œ
- åœ¨çµ„ä»¶ç”Ÿå‘½é€±æœŸçš„ç‰¹å®šæ™‚æ©ŸåŸ·è¡Œç¨‹å¼ç¢¼

## ğŸ¯ ç¯„ä¾‹èªªæ˜

### ç¨‹å¼ç¢¼çµæ§‹

```javascript
function VideoPlayer({ src, isPlaying }) {
  const ref = useRef(null);

  useEffect(() => {
    if (isPlaying) {
      console.log('Calling video.play()');
      ref.current.play();
    } else {
      console.log('Calling video.pause()');
      ref.current.pause();
    }
  }, [isPlaying]); // ğŸ‘ˆ ä¾è³´æ€§é™£åˆ—

  return <video ref={ref} src={src} loop playsInline />;
}
```

### é‡è¦æ¦‚å¿µè§£æ

#### 1. useEffect çš„åŸºæœ¬èªæ³•
```javascript
useEffect(() => {
  // Effect çš„ç¨‹å¼ç¢¼
}, [dependencies]); // ä¾è³´æ€§é™£åˆ—
```

#### 2. ä¾è³´æ€§é™£åˆ— `[isPlaying]`
- **ä½œç”¨**ï¼šå‘Šè¨´ React ä½•æ™‚éœ€è¦é‡æ–°åŸ·è¡Œ Effect
- **è¦å‰‡**ï¼šåªæœ‰ç•¶ `isPlaying` çš„å€¼æ”¹è®Šæ™‚ï¼ŒEffect æ‰æœƒé‡æ–°åŸ·è¡Œ
- **æ¯”è¼ƒ**ï¼šReact ä½¿ç”¨ `Object.is()` ä¾†æ¯”è¼ƒå‰å¾Œçš„å€¼

#### 3. ä¸‰ç¨®ä¾è³´æ€§æƒ…æ³

| ä¾è³´æ€§é™£åˆ— | åŸ·è¡Œæ™‚æ©Ÿ | èªªæ˜ |
|------------|----------|------|
| `[isPlaying]` | `isPlaying` æ”¹è®Šæ™‚ | åªæœ‰ä¾è³´çš„å€¼æ”¹è®Šæ™‚åŸ·è¡Œ |
| `[]` | åƒ…åœ¨çµ„ä»¶æ›è¼‰æ™‚ | ç©ºé™£åˆ— = ç„¡ä¾è³´æ€§ |
| ç„¡é™£åˆ— | æ¯æ¬¡æ¸²æŸ“å¾Œ | ä¸æ¨è–¦ä½¿ç”¨ |

## ğŸš€ å¦‚ä½•é‹è¡Œç¯„ä¾‹

1. **å•Ÿå‹•å°ˆæ¡ˆ**
```bash
npm start
# æˆ–
yarn start
```

2. **äº’å‹•æ¸¬è©¦**
- åœ¨è¼¸å…¥æ¡†ä¸­è¼¸å…¥æ–‡å­—
- é»æ“Š "Play" æŒ‰éˆ•æ’­æ”¾è¦–é »
- é»æ“Š "Pause" æŒ‰éˆ•æš«åœè¦–é »
- è§€å¯Ÿæ§åˆ¶å°è¼¸å‡º

## ğŸ”¬ å¯¦é©—èˆ‡è§€å¯Ÿ

### å¯¦é©— 1ï¼šä¾è³´æ€§çš„ä½œç”¨
1. åœ¨è¼¸å…¥æ¡†ä¸­è¼¸å…¥æ–‡å­—
2. è§€å¯Ÿæ§åˆ¶å°æ˜¯å¦æœ‰æ–°çš„è¨Šæ¯
3. **çµæœ**ï¼šè¼¸å…¥æ–‡å­—ä¸æœƒè§¸ç™¼ Effectï¼Œå› ç‚º `text` ä¸åœ¨ä¾è³´æ€§é™£åˆ—ä¸­

### å¯¦é©— 2ï¼šä¾è³´æ€§æ”¹è®Š
1. é»æ“Š Play/Pause æŒ‰éˆ•
2. è§€å¯Ÿæ§åˆ¶å°çš„ `video.play()` æˆ– `video.pause()` è¨Šæ¯
3. **çµæœ**ï¼šåªæœ‰ `isPlaying` æ”¹è®Šæ™‚æ‰åŸ·è¡Œ Effect

### å¯¦é©— 3ï¼šç§»é™¤ä¾è³´æ€§
å˜—è©¦å°‡ä¾è³´æ€§é™£åˆ—æ”¹ç‚º `[]`ï¼š
```javascript
useEffect(() => {
  // Effect ç¨‹å¼ç¢¼
}, []); // ç©ºé™£åˆ—
```
**çµæœ**ï¼šEffect åªåœ¨çµ„ä»¶æ›è¼‰æ™‚åŸ·è¡Œä¸€æ¬¡

## ğŸ’¡ é‡è¦è§€å¿µ

### 1. Effect çš„åŸ·è¡Œæ™‚æ©Ÿ
- **æ¸²æŸ“ä¹‹å¾Œ**ï¼šEffect åœ¨ DOM æ›´æ–°å®Œæˆå¾ŒåŸ·è¡Œ
- **ä¾è³´æ€§æª¢æŸ¥**ï¼šReact æ¯”è¼ƒå‰å¾Œæ¸²æŸ“çš„ä¾è³´æ€§å€¼
- **æœ‰æ¢ä»¶åŸ·è¡Œ**ï¼šåªæœ‰ä¾è³´æ€§æ”¹è®Šæ™‚æ‰é‡æ–°åŸ·è¡Œ

### 2. ç‚ºä»€éº¼éœ€è¦ä¾è³´æ€§ï¼Ÿ
```javascript
// âŒ æ²’æœ‰ä¾è³´æ€§ - æ¯æ¬¡æ¸²æŸ“éƒ½åŸ·è¡Œ
useEffect(() => {
  console.log('æ¯æ¬¡éƒ½åŸ·è¡Œ');
});

// âœ… æœ‰ä¾è³´æ€§ - åªåœ¨éœ€è¦æ™‚åŸ·è¡Œ
useEffect(() => {
  console.log('åªåœ¨ isPlaying æ”¹è®Šæ™‚åŸ·è¡Œ');
}, [isPlaying]);
```

### 3. ä¾è³´æ€§çš„é¸æ“‡è¦å‰‡
- åŒ…å« Effect ä¸­ä½¿ç”¨çš„æ‰€æœ‰éŸ¿æ‡‰å¼å€¼
- åŒ…å« propsã€state å’Œç”±å®ƒå€‘è¨ˆç®—å‡ºçš„å€¼
- ä¸åŒ…å« ref å’Œ setState å‡½æ•¸ï¼ˆå®ƒå€‘æ˜¯ç©©å®šçš„ï¼‰

## ğŸ“ æœ€ä½³å¯¦è¸

### 1. èª å¯¦åœ°å®£å‘Šä¾è³´æ€§
```javascript
// âœ… æ­£ç¢ºï¼šåŒ…å«æ‰€æœ‰ä½¿ç”¨çš„å€¼
useEffect(() => {
  fetchData(userId, filter);
}, [userId, filter]);

// âŒ éŒ¯èª¤ï¼šéºæ¼ä¾è³´æ€§
useEffect(() => {
  fetchData(userId, filter);
}, [userId]); // éºæ¼äº† filter
```

### 2. ä½¿ç”¨ ESLint æ’ä»¶
å®‰è£ `eslint-plugin-react-hooks` ä¾†è‡ªå‹•æª¢æŸ¥ä¾è³´æ€§ï¼š
```bash
npm install eslint-plugin-react-hooks --save-dev
```

### 3. é¿å…ç‰©ä»¶å’Œå‡½æ•¸ä½œç‚ºä¾è³´æ€§
```javascript
// âŒ å¯èƒ½é€ æˆç„¡é™å¾ªç’°
const options = { userId, filter };
useEffect(() => {
  fetchData(options);
}, [options]);

// âœ… ç›´æ¥ä½¿ç”¨åŸå§‹å€¼
useEffect(() => {
  fetchData({ userId, filter });
}, [userId, filter]);
```

## ğŸ”— ç›¸é—œè³‡æº

- [React å®˜æ–¹æ–‡ä»¶ - useEffect](https://react.dev/reference/react/useEffect)
- [React å®˜æ–¹æ–‡ä»¶ - Synchronizing with Effects](https://react.dev/learn/synchronizing-with-effects)
- [Effect ä¾è³´æ€§è©³ç´°èªªæ˜](https://react.dev/learn/synchronizing-with-effects#sending-analytics)

## ğŸ“ ç·´ç¿’å»ºè­°

1. **ä¿®æ”¹ä¾è³´æ€§é™£åˆ—**ï¼šå˜—è©¦ä¸åŒçš„ä¾è³´æ€§çµ„åˆ
2. **æ·»åŠ æ›´å¤šç‹€æ…‹**ï¼šå¢åŠ æ–°çš„ state ä¸¦è§€å¯Ÿ Effect çš„è¡Œç‚º
3. **ç§»é™¤ä¾è³´æ€§**ï¼šçœ‹çœ‹æœƒç™¼ç”Ÿä»€éº¼å•é¡Œ
4. **ä½¿ç”¨ React DevTools**ï¼šè§€å¯Ÿ Effect çš„åŸ·è¡Œæ™‚æ©Ÿ

## ğŸ¯ ç¸½çµ

- Effect è®“çµ„ä»¶èƒ½å¤ èˆ‡å¤–éƒ¨ç³»çµ±åŒæ­¥
- ä¾è³´æ€§é™£åˆ—æ§åˆ¶ Effect çš„åŸ·è¡Œæ™‚æ©Ÿ
- æ­£ç¢ºçš„ä¾è³´æ€§è¨­å®šå¯ä»¥é¿å…æ€§èƒ½å•é¡Œå’ŒéŒ¯èª¤
- éµå¾ª React çš„ä¾è³´æ€§è¦å‰‡æ˜¯å¯«å‡ºå¯é ç¨‹å¼ç¢¼çš„é—œéµ 