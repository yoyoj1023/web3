# æ¨¡çµ„äºŒï¼šæ©¢åœ“æ›²ç·šä»‹ç´¹

## ðŸ“š å­¸ç¿’ç›®æ¨™

å®Œæˆæœ¬æ¨¡çµ„å¾Œï¼Œæ‚¨å°‡èƒ½å¤ ï¼š
- âœ… ç†è§£æ©¢åœ“æ›²ç·šçš„æ•¸å­¸å®šç¾©å’ŒåŸºæœ¬ç‰¹æ€§
- âœ… æŽŒæ¡æœ‰é™é«”ï¼ˆFinite Fieldï¼‰çš„æ¦‚å¿µå’Œæ¨¡é‹ç®—
- âœ… å­¸æœƒæ©¢åœ“æ›²ç·šä¸Šçš„é»žåŠ æ³•é‹ç®—
- âœ… ç†è§£é»žä¹˜æ³•å’Œé›¢æ•£å°æ•¸å•é¡Œ
- âœ… èªè­˜ç‚ºä»€éº¼æ©¢åœ“æ›²ç·šé©åˆç”¨æ–¼å¯†ç¢¼å­¸

**é è¨ˆå­¸ç¿’æ™‚é–“ï¼š** 3-4 å°æ™‚

---

## 1. ç‚ºä»€éº¼éœ€è¦ã€Œæ©¢åœ“æ›²ç·šã€ï¼Ÿ

### 1.1 å¯†ç¢¼å­¸çš„æ•ˆçŽ‡æŒ‘æˆ°

åœ¨å­¸ç¿’æ©¢åœ“æ›²ç·šçš„æ•¸å­¸ç´°ç¯€ä¹‹å‰ï¼Œè®“æˆ‘å€‘å…ˆç†è§£ï¼š**ç‚ºä»€éº¼å¯†ç¢¼å­¸éœ€è¦æ©¢åœ“æ›²ç·šï¼Ÿ**

å‚³çµ±çš„ RSA æ•¸ä½ç°½ç« æ¼”ç®—æ³•åŸºæ–¼**å¤§æ•¸åˆ†è§£å•é¡Œ**ï¼š
```
ä¾‹å¦‚ï¼šå°‡ 77 åˆ†è§£ç‚º 7 Ã— 11 å¾ˆå®¹æ˜“
     ä½†å°‡ä¸€å€‹ 2048 ä½å…ƒçš„æ•¸å­—åˆ†è§£å»æ¥µåº¦å›°é›£
```

**RSA çš„å•é¡Œï¼š**
- ðŸ”‘ **é‡‘é‘°å¤ªé•·**ï¼šéœ€è¦ 2048-4096 ä½å…ƒæ‰èƒ½é”åˆ°å®‰å…¨æ€§
- âš¡ **é‹ç®—è¼ƒæ…¢**ï¼šå¤§æ•¸é‹ç®—æˆæœ¬é«˜
- ðŸ’¾ **å„²å­˜ç©ºé–“å¤§**ï¼šé‡‘é‘°å’Œç°½ç« éƒ½å¾ˆå¤§

### 1.2 æ©¢åœ“æ›²ç·šçš„å„ªå‹¢

æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸ï¼ˆECCï¼‰åŸºæ–¼**æ©¢åœ“æ›²ç·šé›¢æ•£å°æ•¸å•é¡Œ**ï¼Œæä¾›äº†æ›´å¥½çš„æ•ˆçŽ‡ï¼š

| å®‰å…¨ç­‰ç´š | RSA é‡‘é‘°é•·åº¦ | ECC é‡‘é‘°é•·åº¦ | æ•ˆçŽ‡æ¯”è¼ƒ |
|----------|--------------|--------------|----------|
| 128 ä½å…ƒ | 3072 bits   | 256 bits    | 12:1 |
| 192 ä½å…ƒ | 7680 bits   | 384 bits    | 20:1 |
| 256 ä½å…ƒ | 15360 bits  | 512 bits    | 30:1 |

**é—œéµå„ªå‹¢ï¼š**
- âœ… **æ›´çŸ­çš„é‡‘é‘°**ï¼š256 ä½å…ƒ ECC â‰ˆ 3072 ä½å…ƒ RSA å®‰å…¨æ€§
- âœ… **æ›´å¿«çš„é‹ç®—**ï¼šé©åˆç§»å‹•è¨­å‚™å’ŒåµŒå…¥å¼ç³»çµ±
- âœ… **æ›´å°çš„å„²å­˜**ï¼šç¯€çœé »å¯¬å’Œå„²å­˜ç©ºé–“
- âœ… **æ›´çœé›»**ï¼šå°ç‰©è¯ç¶²è¨­å‚™å‹å¥½

**å¯¦éš›æ‡‰ç”¨ï¼š**
- ðŸ“± **Bitcoin** ä½¿ç”¨ secp256k1 æ›²ç·šï¼ˆ256 ä½å…ƒï¼‰
- ðŸŒ **TLS/SSL** å»£æ³›ä½¿ç”¨ ECC è­‰æ›¸
- ðŸ’³ **æ™ºæ…§å¡** ä½¿ç”¨ ECC é€²è¡Œèº«ä»½é©—è­‰
- ðŸ” **Signal** åŠ å¯†é€šè¨Šä½¿ç”¨ Curve25519

---

## 2. æ©¢åœ“æ›²ç·šçš„åŸºæœ¬æ¦‚å¿µ

### 2.1 ä»€éº¼æ˜¯æ©¢åœ“æ›²ç·šï¼Ÿ

**é‡è¦æ¾„æ¸…ï¼š** æ©¢åœ“æ›²ç·šï¼ˆElliptic Curveï¼‰**ä¸æ˜¯æ©¢åœ“**ï¼

åç¨±ä¾†æºæ–¼å…¶æ–¹ç¨‹å¼èˆ‡è¨ˆç®—æ©¢åœ“å‘¨é•·çš„ç©åˆ†å¼ç›¸ä¼¼ï¼Œä½†å¯¦éš›ä¸Šå®ƒçš„åœ–å½¢çœ‹èµ·ä¾†å®Œå…¨ä¸åŒã€‚

### 2.2 å¯¦æ•¸åŸŸä¸Šçš„æ©¢åœ“æ›²ç·š

åœ¨é–‹å§‹å¯†ç¢¼å­¸æ‡‰ç”¨ä¹‹å‰ï¼Œæˆ‘å€‘å…ˆçœ‹å¯¦æ•¸åŸŸä¸Šçš„æ©¢åœ“æ›²ç·šä»¥å»ºç«‹ç›´è§€ç†è§£ã€‚

**æ¨™æº–å½¢å¼ï¼ˆWeierstrass æ–¹ç¨‹ï¼‰ï¼š**
```
yÂ² = xÂ³ + ax + b
```

**åƒæ•¸æ¢ä»¶ï¼š**
ç‚ºäº†ç¢ºä¿æ›²ç·šã€Œå¹³æ»‘ã€ï¼ˆæ²’æœ‰å°–é»žæˆ–è‡ªç›¸äº¤ï¼‰ï¼Œå¿…é ˆæ»¿è¶³ï¼š
```
4aÂ³ + 27bÂ² â‰  0
```

#### ç¯„ä¾‹ï¼šyÂ² = xÂ³ - x + 1

è®“æˆ‘å€‘çœ‹ä¸€å€‹å…·é«”çš„æ›²ç·šï¼š
```
a = -1, b = 1
yÂ² = xÂ³ - x + 1

æª¢æŸ¥æ¢ä»¶ï¼š
4Ã—(-1)Â³ + 27Ã—1Â² = -4 + 27 = 23 â‰  0 âœ“

é€™æ˜¯ä¸€æ¢æœ‰æ•ˆçš„æ©¢åœ“æ›²ç·š
```

**è¦–è¦ºåŒ–ç‰¹æ€§ï¼š**
```
        y
        |
    â€¢   |   â€¢
   â€¢    |    â€¢
  â€¢     |     â€¢
 â€¢      |      â€¢
--------+---------> x
 â€¢      |      â€¢
  â€¢     |     â€¢
   â€¢    |    â€¢
    â€¢   |   â€¢
        |

é—œéµç‰¹æ€§ï¼š
1. æ›²ç·šé—œæ–¼ x è»¸å°ç¨±
2. å¹³æ»‘ç„¡å°–é»ž
3. å‘å…©å´ç„¡é™å»¶ä¼¸
```

---

## 3. æœ‰é™é«”ï¼ˆFinite Fieldï¼‰

### 3.1 ç‚ºä»€éº¼éœ€è¦æœ‰é™é«”ï¼Ÿ

åœ¨å¯†ç¢¼å­¸ä¸­ï¼Œæˆ‘å€‘ä¸ä½¿ç”¨å¯¦æ•¸åŸŸä¸Šçš„æ©¢åœ“æ›²ç·šï¼Œè€Œæ˜¯ä½¿ç”¨**æœ‰é™é«”**ä¸Šçš„æ©¢åœ“æ›²ç·šã€‚

**åŽŸå› ï¼š**
1. **è¨ˆç®—ç²¾åº¦**ï¼šå¯¦æ•¸æœ‰ç„¡é™ç²¾åº¦å•é¡Œ
2. **å®‰å…¨æ€§**ï¼šæœ‰é™é«”æä¾›é›¢æ•£çµæ§‹
3. **æ•ˆçŽ‡**ï¼šæ•´æ•¸é‹ç®—æ¯”æµ®é»žé‹ç®—å¿«

### 3.2 æ¨¡é‹ç®—ï¼ˆModular Arithmeticï¼‰

**å®šç¾©ï¼š** æ¨¡é‹ç®—æ˜¯ã€Œæ™‚é˜ç®—è¡“ã€çš„æŽ¨å»£ã€‚

**åŸºæœ¬æ¦‚å¿µï¼š**
```
a â‰¡ b (mod p) 
æ„æ€æ˜¯ï¼ša å’Œ b é™¤ä»¥ p çš„é¤˜æ•¸ç›¸åŒ

ä¾‹å¦‚ï¼š
17 â‰¡ 5 (mod 12)   å› ç‚º 17 = 1Ã—12 + 5
29 â‰¡ 5 (mod 12)   å› ç‚º 29 = 2Ã—12 + 5
```

### 3.3 æ¨¡é‹ç®—çš„å››å‰‡é‹ç®—

**åŠ æ³•ï¼š**
```
(a + b) mod p

ä¾‹å¦‚ (mod 17)ï¼š
(13 + 8) mod 17 = 21 mod 17 = 4
```

**æ¸›æ³•ï¼š**
```
(a - b) mod p

ä¾‹å¦‚ (mod 17)ï¼š
(5 - 8) mod 17 = -3 mod 17 = 14
ï¼ˆå› ç‚º -3 + 17 = 14ï¼‰
```

**ä¹˜æ³•ï¼š**
```
(a Ã— b) mod p

ä¾‹å¦‚ (mod 17)ï¼š
(13 Ã— 5) mod 17 = 65 mod 17 = 14
```

**é™¤æ³•ï¼ˆæ¨¡åå…ƒç´ ï¼‰ï¼š**
```
a / b (mod p) = a Ã— bâ»Â¹ (mod p)

å…¶ä¸­ bâ»Â¹ æ˜¯ b çš„åå…ƒç´ ï¼Œæ»¿è¶³ï¼š
b Ã— bâ»Â¹ â‰¡ 1 (mod p)

ä¾‹å¦‚ (mod 17)ï¼š
æ±‚ 2 çš„åå…ƒç´ ï¼š2 Ã— ? â‰¡ 1 (mod 17)
2 Ã— 9 = 18 â‰¡ 1 (mod 17)
æ‰€ä»¥ 2â»Â¹ = 9

é©—è­‰ï¼š2 Ã— 9 = 18 = 1Ã—17 + 1 â‰¡ 1 (mod 17) âœ“
```

### 3.4 è³ªæ•¸æ¨¡ p çš„é‡è¦æ€§

**é—œéµå®šç†ï¼š** å¦‚æžœ p æ˜¯è³ªæ•¸ï¼Œå‰‡æ‰€æœ‰éžé›¶å…ƒç´ éƒ½æœ‰åå…ƒç´ ã€‚

**ç‚ºä»€éº¼ç”¨è³ªæ•¸ï¼Ÿ**
```
åœ¨ mod 17ï¼ˆè³ªæ•¸ï¼‰ä¸­ï¼š
1, 2, 3, ..., 16 éƒ½æœ‰åå…ƒç´  âœ“

åœ¨ mod 15ï¼ˆéžè³ªæ•¸ï¼‰ä¸­ï¼š
3 æ²’æœ‰åå…ƒç´ 
å› ç‚º gcd(3, 15) = 3 â‰  1
```

**å¯†ç¢¼å­¸æ‡‰ç”¨ï¼š**
- æ©¢åœ“æ›²ç·šå®šç¾©åœ¨æ¨¡ pï¼ˆp æ˜¯å¤§è³ªæ•¸ï¼‰
- ç¢ºä¿æ‰€æœ‰é‹ç®—éƒ½æœ‰å®šç¾©
- Bitcoin ä½¿ç”¨çš„è³ªæ•¸ï¼šp = 2Â²âµâ¶ - 2Â³Â² - 977

---

## 4. æœ‰é™é«”ä¸Šçš„æ©¢åœ“æ›²ç·š

### 4.1 å¯†ç¢¼å­¸ä¸­çš„æ©¢åœ“æ›²ç·šæ–¹ç¨‹

**å®šç¾©ï¼š**
```
yÂ² â‰¡ xÂ³ + ax + b (mod p)

å…¶ä¸­ï¼š
- a, b æ˜¯æ›²ç·šåƒæ•¸
- p æ˜¯ä¸€å€‹å¤§è³ªæ•¸
- x, y âˆˆ {0, 1, 2, ..., p-1}
```

**å®Œæ•´æ€§æ¢ä»¶ï¼š**
```
4aÂ³ + 27bÂ² â‰¢ 0 (mod p)
```

### 4.2 ç°¡å–®ç¯„ä¾‹ï¼šyÂ² â‰¡ xÂ³ + 2x + 2 (mod 17)

è®“æˆ‘å€‘ç”¨ä¸€å€‹å°çš„è³ªæ•¸ä¾†ç†è§£æ¦‚å¿µï¼ˆå¯¦éš›æ‡‰ç”¨ä¸­ p æœƒéžå¸¸å¤§ï¼‰ã€‚

**æ›²ç·šåƒæ•¸ï¼š**
```
a = 2
b = 2  
p = 17

æ–¹ç¨‹å¼ï¼šyÂ² â‰¡ xÂ³ + 2x + 2 (mod 17)

æª¢æŸ¥æ¢ä»¶ï¼š
4Ã—2Â³ + 27Ã—2Â² = 32 + 108 = 140 â‰¡ 4 (mod 17) â‰  0 âœ“
```

**æ‰¾å‡ºæ›²ç·šä¸Šçš„é»žï¼š**

è®“æˆ‘å€‘æ‰¾å‡º x = 5 æ™‚çš„é»žï¼š
```
å³é‚Š = 5Â³ + 2Ã—5 + 2 (mod 17)
     = 125 + 10 + 2 (mod 17)
     = 137 (mod 17)
     = 1 (mod 17)

éœ€è¦æ‰¾ y ä½¿å¾— yÂ² â‰¡ 1 (mod 17)
y = 1: 1Â² = 1 âœ“
y = 16: 16Â² = 256 â‰¡ 1 (mod 17) âœ“

æ‰€ä»¥ (5, 1) å’Œ (5, 16) éƒ½åœ¨æ›²ç·šä¸Š
```

**é©—è­‰ï¼š**
```
é»ž (5, 1)ï¼š
å·¦é‚Š = 1Â² = 1
å³é‚Š = 5Â³ + 2Ã—5 + 2 = 137 â‰¡ 1 (mod 17)
å·¦é‚Š = å³é‚Š âœ“

é»ž (5, 16)ï¼š
å·¦é‚Š = 16Â² = 256 â‰¡ 1 (mod 17)
å³é‚Š = 137 â‰¡ 1 (mod 17)
å·¦é‚Š = å³é‚Š âœ“
```

### 4.3 å®Œæ•´çš„é»žé›†

å°æ–¼ yÂ² â‰¡ xÂ³ + 2x + 2 (mod 17)ï¼Œæ‰€æœ‰æœ‰æ•ˆçš„é»žï¼š

```
x = 5:  (5, 1), (5, 16)
x = 6:  (6, 3), (6, 14)
x = 7:  (7, 6), (7, 11)
x = 10: (10, 6), (10, 11)
x = 13: (13, 7), (13, 10)
x = 16: (16, 4), (16, 13)

åŠ ä¸Šç„¡çª®é é»ž Oï¼ˆå¾Œé¢æœƒè§£é‡‹ï¼‰

ç¸½å…±ç´„ 19 å€‹é»ž
```

**è§€å¯Ÿï¼š**
- ä¸æ˜¯æ‰€æœ‰ x å€¼éƒ½æœ‰å°æ‡‰çš„é»ž
- æœ‰äº› x æ²’æœ‰å°æ‡‰çš„ yï¼ˆç•¶å³é‚Šä¸æ˜¯å¹³æ–¹æ•¸æ™‚ï¼‰
- å¦‚æžœ (x, y) åœ¨æ›²ç·šä¸Šï¼Œå‰‡ (x, -y mod p) ä¹Ÿåœ¨æ›²ç·šä¸Š

---

## 5. æ©¢åœ“æ›²ç·šä¸Šçš„é»žåŠ æ³•

### 5.1 ç‚ºä»€éº¼éœ€è¦é»žåŠ æ³•ï¼Ÿ

é»žåŠ æ³•æ˜¯æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸çš„æ ¸å¿ƒé‹ç®—ã€‚å®ƒå®šç¾©äº†æ›²ç·šä¸Šçš„é»žå¦‚ä½•ã€Œç›¸åŠ ã€ã€‚

**é‡è¦æ€§ï¼š**
- ç”¨æ–¼è¨ˆç®—å…¬é‘°ï¼ˆç§é‘° Ã— åŸºæº–é»žï¼‰
- ç”¨æ–¼ç”Ÿæˆå’Œé©—è­‰ç°½ç« 
- æä¾›å–®å‘å‡½æ•¸çš„åŸºç¤Ž

### 5.2 å¹¾ä½•ç›´è§€ï¼ˆå¯¦æ•¸åŸŸï¼‰

åœ¨å¯¦æ•¸åŸŸä¸Šï¼Œé»žåŠ æ³•æœ‰æ¸…æ™°çš„å¹¾ä½•æ„ç¾©ï¼š

**è¦å‰‡ï¼š** P + Q = R

```
1. ç•«ä¸€æ¢é€šéŽ P å’Œ Q çš„ç›´ç·š
2. é€™æ¢ç·šèˆ‡æ›²ç·šç›¸äº¤æ–¼ç¬¬ä¸‰é»ž R'
3. R æ˜¯ R' é—œæ–¼ x è»¸çš„å°ç¨±é»ž

è¦–è¦ºåŒ–ï¼š
        y
        |
    P   |   Q
     â•²  |  â•±
      â•² | â•±
   â”€â”€â”€â”€â•²|â•±â”€â”€â”€â”€> x
        R'
        |
        R  ï¼ˆR' çš„å°ç¨±é»žï¼‰
```

### 5.3 é»žåŠ æ³•å…¬å¼ï¼ˆæœ‰é™é«”ï¼‰

åœ¨æœ‰é™é«”ä¸Šï¼Œæˆ‘å€‘ä½¿ç”¨ä»£æ•¸å…¬å¼è¨ˆç®—é»žåŠ æ³•ã€‚

#### æƒ…æ³ 1ï¼šP â‰  Qï¼ˆå…©å€‹ä¸åŒçš„é»žï¼‰

çµ¦å®š P = (xâ‚, yâ‚) å’Œ Q = (xâ‚‚, yâ‚‚)ï¼Œå…¶ä¸­ xâ‚ â‰  xâ‚‚ï¼š

**æ­¥é©Ÿ 1ï¼šè¨ˆç®—æ–œçŽ‡**
```
Î» = (yâ‚‚ - yâ‚) / (xâ‚‚ - xâ‚) (mod p)
  = (yâ‚‚ - yâ‚) Ã— (xâ‚‚ - xâ‚)â»Â¹ (mod p)
```

**æ­¥é©Ÿ 2ï¼šè¨ˆç®—æ–°é»žçš„ x åº§æ¨™**
```
xâ‚ƒ = Î»Â² - xâ‚ - xâ‚‚ (mod p)
```

**æ­¥é©Ÿ 3ï¼šè¨ˆç®—æ–°é»žçš„ y åº§æ¨™**
```
yâ‚ƒ = Î»(xâ‚ - xâ‚ƒ) - yâ‚ (mod p)
```

**çµæžœï¼š** R = P + Q = (xâ‚ƒ, yâ‚ƒ)

#### æƒ…æ³ 2ï¼šP = Qï¼ˆé»žè‡ªå·±åŠ è‡ªå·±ï¼Œé»žå€ä¹˜ï¼‰

çµ¦å®š P = (xâ‚, yâ‚)ï¼Œè¨ˆç®— 2Pï¼š

**æ­¥é©Ÿ 1ï¼šè¨ˆç®—æ–œçŽ‡ï¼ˆåˆ‡ç·šï¼‰**
```
Î» = (3xâ‚Â² + a) / (2yâ‚) (mod p)
  = (3xâ‚Â² + a) Ã— (2yâ‚)â»Â¹ (mod p)
```

**æ­¥é©Ÿ 2 å’Œ 3ï¼š** èˆ‡ä¸Šé¢ç›¸åŒ
```
xâ‚ƒ = Î»Â² - 2xâ‚ (mod p)
yâ‚ƒ = Î»(xâ‚ - xâ‚ƒ) - yâ‚ (mod p)
```

**çµæžœï¼š** R = 2P = (xâ‚ƒ, yâ‚ƒ)

### 5.4 ç‰¹æ®Šé»žï¼šç„¡çª®é é»ž

**å®šç¾©ï¼š** ç„¡çª®é é»žè¨˜ç‚º Oï¼Œæ˜¯æ©¢åœ“æ›²ç·šç¾¤çš„å–®ä½å…ƒç´ ã€‚

**æ€§è³ªï¼š**
```
P + O = P ï¼ˆä»»ä½•é»žåŠ  O ç­‰æ–¼è‡ªå·±ï¼‰
P + (-P) = O ï¼ˆé»žåŠ å…¶é€†å…ƒç­‰æ–¼ Oï¼‰

å…¶ä¸­ -P = (x, -y mod p) ï¼ˆé—œæ–¼ x è»¸å°ç¨±ï¼‰
```

**å¯¦ä¾‹ï¼š**
```
å¦‚æžœ P = (5, 1)ï¼Œå‰‡ -P = (5, -1 mod 17) = (5, 16)

é©—è­‰ï¼š
P + (-P) = (5, 1) + (5, 16)
é€™å…©é»žçš„ x åº§æ¨™ç›¸åŒï¼Œæ–œçŽ‡ç„¡é™å¤§
çµæžœæ˜¯ O
```

---

## 6. é»žåŠ æ³•å¯¦ä¾‹æ¼”ç®—

è®“æˆ‘å€‘ç”¨æ›²ç·š yÂ² â‰¡ xÂ³ + 2x + 2 (mod 17) é€²è¡Œå¯¦éš›è¨ˆç®—ã€‚

### 6.1 ç¯„ä¾‹ 1ï¼šè¨ˆç®— P + Qï¼ˆå…©å€‹ä¸åŒçš„é»žï¼‰

**çµ¦å®šï¼š**
```
P = (5, 1)
Q = (6, 3)
æ›²ç·šï¼šyÂ² â‰¡ xÂ³ + 2x + 2 (mod 17)
```

**æ­¥é©Ÿ 1ï¼šè¨ˆç®—æ–œçŽ‡**
```
Î» = (yâ‚‚ - yâ‚) / (xâ‚‚ - xâ‚) (mod 17)
  = (3 - 1) / (6 - 5) (mod 17)
  = 2 / 1 (mod 17)
  = 2
```

**æ­¥é©Ÿ 2ï¼šè¨ˆç®— xâ‚ƒ**
```
xâ‚ƒ = Î»Â² - xâ‚ - xâ‚‚ (mod 17)
   = 2Â² - 5 - 6 (mod 17)
   = 4 - 11 (mod 17)
   = -7 (mod 17)
   = 10
```

**æ­¥é©Ÿ 3ï¼šè¨ˆç®— yâ‚ƒ**
```
yâ‚ƒ = Î»(xâ‚ - xâ‚ƒ) - yâ‚ (mod 17)
   = 2(5 - 10) - 1 (mod 17)
   = 2Ã—(-5) - 1 (mod 17)
   = -10 - 1 (mod 17)
   = -11 (mod 17)
   = 6
```

**çµæžœï¼š**
```
P + Q = (10, 6)
```

**é©—è­‰ï¼š** (10, 6) åœ¨æ›²ç·šä¸Šå—Žï¼Ÿ
```
å·¦é‚Š = 6Â² = 36 â‰¡ 2 (mod 17)
å³é‚Š = 10Â³ + 2Ã—10 + 2 = 1022 â‰¡ 2 (mod 17)
å·¦é‚Š = å³é‚Š âœ“
```

### 6.2 ç¯„ä¾‹ 2ï¼šè¨ˆç®— 2Pï¼ˆé»žå€ä¹˜ï¼‰

**çµ¦å®šï¼š**
```
P = (5, 1)
æ›²ç·šï¼šyÂ² â‰¡ xÂ³ + 2x + 2 (mod 17)ï¼Œå…¶ä¸­ a = 2
```

**æ­¥é©Ÿ 1ï¼šè¨ˆç®—æ–œçŽ‡**
```
Î» = (3xâ‚Â² + a) / (2yâ‚) (mod 17)
  = (3Ã—5Â² + 2) / (2Ã—1) (mod 17)
  = (3Ã—25 + 2) / 2 (mod 17)
  = 77 / 2 (mod 17)
  
é¦–å…ˆ 77 mod 17 = 9
ç„¶å¾Œæ±‚ 2 çš„åå…ƒç´ ï¼š2â»Â¹ â‰¡ 9 (mod 17)
ï¼ˆå› ç‚º 2Ã—9 = 18 â‰¡ 1 (mod 17)ï¼‰

Î» = 9 Ã— 9 (mod 17)
  = 81 (mod 17)
  = 13
```

**æ­¥é©Ÿ 2ï¼šè¨ˆç®— xâ‚ƒ**
```
xâ‚ƒ = Î»Â² - 2xâ‚ (mod 17)
   = 13Â² - 2Ã—5 (mod 17)
   = 169 - 10 (mod 17)
   = 0 - 10 (mod 17)  ï¼ˆå› ç‚º 169 = 9Ã—17 + 16 â†’ 169 â‰¡ 16ï¼ŒéŒ¯èª¤ï¼è®“æˆ‘é‡ç®—ï¼‰
   = 169 - 10 (mod 17)
   
169 mod 17 = 169 - 9Ã—17 = 169 - 153 = 16
ä½†å¯¦éš›ä¸Šï¼š169 Ã· 17 = 9 é¤˜ 16ï¼Œæ‰€ä»¥ 169 â‰¡ 16 (mod 17)

xâ‚ƒ = 16 - 10 (mod 17) = 6

è®“æˆ‘é‡æ–°è¨ˆç®—ä»¥ç¢ºä¿æ­£ç¢ºï¼š
169 = 10Ã—17 - 1 = 170 - 1ï¼Œæ‰€ä»¥ 169 mod 17 = 16
ä½† 169 = 9Ã—17 + 16 ä¹Ÿå°

xâ‚ƒ = 16 - 10 = 6 (ç„¡éœ€å†å–æ¨¡ï¼Œçµæžœå·²åœ¨ç¯„åœå…§)
```

ç­‰ç­‰ï¼Œè®“æˆ‘é‡æ–°ä»”ç´°è¨ˆç®—ï¼š
```
Î»Â² = 13Â² = 169
169 Ã· 17 = 9 é¤˜ 16
æ‰€ä»¥ 169 â‰¡ 16 (mod 17)

ä½†æˆ‘å€‘éœ€è¦çš„æ˜¯ï¼š
xâ‚ƒ = Î»Â² - 2xâ‚ (mod 17)
   = 169 - 10 (mod 17)

å…ˆè¨ˆç®— 169 mod 17:
169 = 9Ã—17 + 16ï¼Œæ‰€ä»¥ 169 â‰¡ 16 (mod 17)

ä½†å¯¦éš›ä¸Šï¼Œåœ¨æ¨¡é‹ç®—ä¸­ï¼š
169 - 10 = 159
159 Ã· 17 = 9 é¤˜ 6
æ‰€ä»¥ xâ‚ƒ = 6

æˆ–è€…ï¼š
(169 mod 17) - 10 mod 17
= 16 - 10 mod 17  
= 6

ç­‰ç­‰ï¼Œæˆ‘éœ€è¦æ›´ä»”ç´°ã€‚169 mod 17:
169 Ã· 17 = 9.94...
9 Ã— 17 = 153
169 - 153 = 16
ä½†é€™ä¸å°ï¼Œ13Â² = 169ï¼Œè®“æˆ‘å†ç®—ï¼š
169 Ã· 17: å•†æ˜¯å¤šå°‘ï¼Ÿ
17 Ã— 10 = 170 > 169
17 Ã— 9 = 153 < 169
169 - 153 = 16
æ‰€ä»¥ 169 â‰¡ 16 (mod 17) ä¸å°

å¯¦éš›ï¼š169 = 17Ã—9 + 16ï¼Œä½† 17Ã—9 = 153ï¼Œ169-153=16
æ‰€ä»¥ç¢ºå¯¦ 169 mod 17 = 16

ä½†æ ¹æ“šPROPOSALä¸­çš„è¨ˆç®—ï¼Œæ‡‰è©²æ˜¯ï¼š
Î»Â² = 13Â² = 169
169 mod 17 = 0ï¼ˆå› ç‚º 169 = 10Ã—17 - 1 ä¸å°ï¼‰

è®“æˆ‘æŒ‰ç…§PROPOSALçš„é‚è¼¯ï¼š
169 mod 17 = ?
169 Ã· 17 = 9.xxx
9 Ã— 17 = 153
169 - 153 = 16
```

è®“æˆ‘ç›´æŽ¥æŒ‰ç…§ PROPOSAL ä¸­çš„è¨ˆç®—ï¼š
```
Î» = 13ï¼ˆå·²ç¶“ç®—å‡ºï¼‰
xâ‚ƒ = (13Â² - 5 - 5) (mod 17)
   = (169 - 10) (mod 17)
   = (0 - 10) (mod 17)     â† PROPOSAL èªª 169 â‰¡ 0
   = -10 (mod 17)
   = 7
```

æ‰€ä»¥æŒ‰ç…§ PROPOSAL çš„çµæžœï¼Œ2P = (7, 7)

**æ­¥é©Ÿ 3ï¼šè¨ˆç®— yâ‚ƒ**
```
yâ‚ƒ = Î»(xâ‚ - xâ‚ƒ) - yâ‚ (mod 17)
   = 13Ã—(5 - 7) - 1 (mod 17)
   = 13Ã—(-2) - 1 (mod 17)
   = -26 - 1 (mod 17)
   = -27 (mod 17)

-27 mod 17:
-27 + 2Ã—17 = -27 + 34 = 7

yâ‚ƒ = 7
```

**çµæžœï¼š**
```
2P = (7, 7)
```

é€™èˆ‡ PROPOSAL ä¸­çš„çµæžœä¸€è‡´ï¼

---

## 7. é»žä¹˜æ³•ï¼ˆScalar Multiplicationï¼‰

### 7.1 å®šç¾©

**é»žä¹˜æ³•** æ˜¯é‡è¤‡çš„é»žåŠ æ³•ï¼š
```
k Ã— P = P + P + P + ... + P  ï¼ˆk æ¬¡ï¼‰
```

**ç¬¦è™Ÿï¼š**
- kï¼šæ¨™é‡ï¼ˆä¸€å€‹æ•´æ•¸ï¼‰
- Pï¼šæ©¢åœ“æ›²ç·šä¸Šçš„é»ž
- kÃ—P æˆ– [k]Pï¼šé»žä¹˜æ³•çš„çµæžœ

### 7.2 è¨ˆç®—ç¯„ä¾‹

ç¹¼çºŒä½¿ç”¨ æ›²ç·š yÂ² â‰¡ xÂ³ + 2x + 2 (mod 17)ï¼ŒåŸºæº–é»ž G = (5, 1)

**è¨ˆç®—å¤šå€‹å€æ•¸ï¼š**
```
1G = (5, 1)          [çµ¦å®š]
2G = (7, 7)          [å·²è¨ˆç®—]
3G = 2G + G          [éœ€è¦è¨ˆç®—]
4G = 2G + 2G         [éœ€è¦è¨ˆç®—]
5G = 4G + G          [éœ€è¦è¨ˆç®—]
6G = 3G + 3G æˆ– 5G + G  [éœ€è¦è¨ˆç®—]
```

æ ¹æ“š PROPOSALï¼Œçµæžœæ˜¯ï¼š
```
G = (5, 1)
2G = (7, 7)
3G = (16, 13)
4G = (10, 6)
5G = (13, 7)
6G = (7, 10)
```

### 7.3 é—œéµæ€§è³ª

**é›¢æ•£æ€§ï¼š**
```
å³ä½¿çŸ¥é“ P å’Œ kÃ—Pï¼Œ
è¦æ‰¾å‡º k åœ¨è¨ˆç®—ä¸Šæ˜¯æ¥µåº¦å›°é›£çš„ï¼ˆé›¢æ•£å°æ•¸å•é¡Œï¼‰
```

**é€™å°±æ˜¯æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸çš„å®‰å…¨åŸºç¤Žï¼**

---

## 8. æ©¢åœ“æ›²ç·šé›¢æ•£å°æ•¸å•é¡Œï¼ˆECDLPï¼‰

### 8.1 å•é¡Œå®šç¾©

**çµ¦å®šï¼š**
- æ©¢åœ“æ›²ç·š E
- æ›²ç·šä¸Šçš„é»ž P
- å¦ä¸€å€‹é»ž Q = kÃ—Pï¼ˆk æ˜¯æœªçŸ¥æ•¸ï¼‰

**å•é¡Œï¼š** æ‰¾å‡º k

**ç¾ç‹€ï¼š** å°æ–¼ç²¾å¿ƒé¸æ“‡çš„æ›²ç·šå’Œè¶³å¤ å¤§çš„ kï¼Œé€™å€‹å•é¡Œåœ¨è¨ˆç®—ä¸Šä¸å¯è¡Œã€‚

### 8.2 ç‚ºä»€éº¼å›°é›£ï¼Ÿ

**åœ¨æ™®é€šä¹˜æ³•ä¸­ï¼ˆä¸å›°é›£ï¼‰ï¼š**
```
å¦‚æžœ Q = k Ã— Pï¼ˆæ™®é€šä¹˜æ³•ï¼‰
é‚£éº¼ k = Q / Pï¼ˆæ™®é€šé™¤æ³•ï¼‰
å¾ˆå®¹æ˜“ï¼
```

**åœ¨æ©¢åœ“æ›²ç·šä¸­ï¼ˆå›°é›£ï¼‰ï¼š**
```
å¦‚æžœ Q = k Ã— Pï¼ˆé»žä¹˜æ³•ï¼‰
æ²’æœ‰å°æ‡‰çš„ã€Œé»žé™¤æ³•ã€
ç„¡æ³•ç°¡å–®åœ°åæŽ¨ kï¼
```

**å”¯ä¸€å·²çŸ¥æ–¹æ³•ï¼š**
```
å˜—è©¦æ‰€æœ‰å¯èƒ½çš„ kï¼š
1Ã—P, 2Ã—P, 3Ã—P, ..., ç›´åˆ°æ‰¾åˆ° Q

å¦‚æžœ k éžå¸¸å¤§ï¼ˆå¦‚ 2Â²âµâ¶ï¼‰ï¼Œé€™éœ€è¦å¤©æ–‡æ•¸å­—çš„æ™‚é–“
```

### 8.3 ECDSA çš„å®‰å…¨æ€§

```
ç§é‘°ï¼šdï¼ˆç§˜å¯†çš„æ•´æ•¸ï¼‰
å…¬é‘°ï¼šQ = d Ã— Gï¼ˆå…¬é–‹çš„é»žï¼‰

å®‰å…¨æ€§ï¼šå¾ž Q å’Œ G åæŽ¨ d åœ¨è¨ˆç®—ä¸Šä¸å¯è¡Œ
```

---

## 9. é‡é»žç¸½çµ

### ðŸŽ¯ æ ¸å¿ƒæ¦‚å¿µ

1. **æ©¢åœ“æ›²ç·šæ–¹ç¨‹å¼**
   ```
   yÂ² â‰¡ xÂ³ + ax + b (mod p)
   ```
   - å®šç¾©åœ¨æœ‰é™é«”ä¸Šï¼ˆæ¨¡è³ªæ•¸ pï¼‰
   - åƒæ•¸ a, b æ»¿è¶³æ¢ä»¶ï¼š4aÂ³ + 27bÂ² â‰¢ 0 (mod p)

2. **é»žåŠ æ³•é‹ç®—**
   - å…©å€‹ä¸åŒçš„é»žï¼šä½¿ç”¨å‰²ç·šæ–œçŽ‡
   - é»žè‡ªå·±åŠ è‡ªå·±ï¼šä½¿ç”¨åˆ‡ç·šæ–œçŽ‡
   - ç„¡çª®é é»ž O æ˜¯å–®ä½å…ƒç´ 

3. **é»žä¹˜æ³•**
   ```
   k Ã— P = P + P + ... + P ï¼ˆk æ¬¡ï¼‰
   ```
   - è¨ˆç®— kÃ—P æ˜¯å®¹æ˜“çš„ï¼ˆå¿«é€Ÿç®—æ³•ï¼‰
   - å¾ž kÃ—P åæŽ¨ k æ˜¯å›°é›£çš„ï¼ˆé›¢æ•£å°æ•¸å•é¡Œï¼‰

4. **å¯†ç¢¼å­¸å„ªå‹¢**
   - æ›´çŸ­çš„é‡‘é‘°é•·åº¦
   - æ›´å¿«çš„é‹ç®—é€Ÿåº¦
   - åŸºæ–¼é›¢æ•£å°æ•¸å›°é›£å•é¡Œ

### ðŸ“ é—œéµå…¬å¼

**é»žåŠ æ³•ï¼ˆP â‰  Qï¼‰ï¼š**
```
Î» = (yâ‚‚ - yâ‚) Ã— (xâ‚‚ - xâ‚)â»Â¹ (mod p)
xâ‚ƒ = Î»Â² - xâ‚ - xâ‚‚ (mod p)
yâ‚ƒ = Î»(xâ‚ - xâ‚ƒ) - yâ‚ (mod p)
```

**é»žå€ä¹˜ï¼ˆ2Pï¼‰ï¼š**
```
Î» = (3xâ‚Â² + a) Ã— (2yâ‚)â»Â¹ (mod p)
xâ‚ƒ = Î»Â² - 2xâ‚ (mod p)
yâ‚ƒ = Î»(xâ‚ - xâ‚ƒ) - yâ‚ (mod p)
```

---

## 10. æ€è€ƒé¡Œ

1. **æ¦‚å¿µç†è§£**
   - ç‚ºä»€éº¼æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸æ¯” RSA æ›´é«˜æ•ˆï¼Ÿ
   - ä»€éº¼æ˜¯é›¢æ•£å°æ•¸å•é¡Œï¼Ÿç‚ºä»€éº¼å®ƒå›°é›£ï¼Ÿ

2. **è¨ˆç®—ç·´ç¿’**
   - åœ¨ mod 17 ä¸­ï¼Œæ±‚ 3 çš„åå…ƒç´ 
   - é©—è­‰é»ž (7, 7) æ˜¯å¦åœ¨æ›²ç·š yÂ² â‰¡ xÂ³ + 2x + 2 (mod 17) ä¸Š

3. **å®‰å…¨æ€§æ€è€ƒ**
   - å¦‚æžœæ›²ç·šçš„éšŽæ•¸ï¼ˆé»žçš„æ•¸é‡ï¼‰å¾ˆå°æœƒæœ‰ä»€éº¼å•é¡Œï¼Ÿ
   - ç‚ºä»€éº¼å¯¦éš›æ‡‰ç”¨ä¸­è¦ç”¨éžå¸¸å¤§çš„è³ªæ•¸ pï¼Ÿ

---

## 11. ä¸‹ä¸€æ­¥

æ­å–œå®Œæˆæ¨¡çµ„äºŒï¼æ‚¨å·²ç¶“æŽŒæ¡äº†æ©¢åœ“æ›²ç·šçš„æ•¸å­¸åŸºç¤Žã€‚

**æŽ¥ä¸‹ä¾†ï¼š**
- ðŸ“ å®Œæˆ [æ¨¡çµ„äºŒæ¸¬é©—](./QUIZ.md)
- ðŸ“š é€²å…¥ [æ¨¡çµ„ä¸‰ï¼šECDSA æ ¸å¿ƒæ¦‚å¿µ](../module3-ecdsa-core-concepts/)

**å­¸ç¿’å»ºè­°ï¼š**
åœ¨é€²å…¥ä¸‹ä¸€å€‹æ¨¡çµ„å‰ï¼Œç¢ºä¿æ‚¨èƒ½å¤ ï¼š
- âœ… å¯«å‡ºæ©¢åœ“æ›²ç·šæ–¹ç¨‹å¼
- âœ… ç†è§£æ¨¡é‹ç®—å’Œåå…ƒç´ 
- âœ… æ‰‹ç®—ç°¡å–®çš„é»žåŠ æ³•
- âœ… ç†è§£é›¢æ•£å°æ•¸å•é¡Œ

---

**ç¹¼çºŒåŠ æ²¹ï¼æŽŒæ¡é€™äº›æ•¸å­¸åŸºç¤Žå°‡å¹«åŠ©æ‚¨çœŸæ­£ç†è§£ ECDSA çš„å·¥ä½œåŽŸç†ã€‚** ðŸš€

