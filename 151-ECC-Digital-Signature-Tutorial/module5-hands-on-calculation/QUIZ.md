# 模組五測驗：手算演練

**測驗時間：** 40 分鐘  
**總分：** 100 分  
**及格分數：** 70 分

---

## 📝 測驗說明

- 本測驗以計算題為主，需要實際手算
- 可以使用計算器輔助基本運算
- 重點在於理解每個步驟的過程
- 建議準備草稿紙進行計算

---

## 第一部分：基礎計算（30 分）

### 1. 模反元素計算（10 分）

計算以下模反元素：

a) 3⁻¹ mod 17（3 分）  
b) 7⁻¹ mod 19（3 分）  
c) 15⁻¹ mod 17（4 分）

**答案空間：**
```
[請在此處填寫您的答案]









```

---

### 2. 點加法計算（20 分）

**給定曲線：** y² ≡ x³ + 2x + 2 (mod 17)

計算：

a) P + Q，其中 P = (5, 1), Q = (6, 3)（10 分）  
b) 2P，其中 P = (10, 6)（10 分）

**答案空間：**
```
[請在此處填寫您的答案]





















```

---

## 第二部分：公鑰生成（20 分）

### 3. 公鑰計算

**給定：**
```
曲線：y² ≡ x³ + 2x + 2 (mod 17)
基準點 G = (5, 1)
私鑰 d = 4
```

**問題：**
計算公鑰 Q = 4 × G

提示：可以使用 2G 的結果重複利用

**答案空間：**
```
[請在此處填寫您的答案]





















```

---

## 第三部分：簽署流程（25 分）

### 4. 完整簽署計算

**給定：**
```
曲線：y² ≡ x³ + 2x + 2 (mod 17)
基準點 G = (5, 1)
階數 n = 19
私鑰 d = 4
訊息雜湊 z = 7
隨機數 k = 3
```

**問題：**
a) 計算簽章點 3G（8 分）  
b) 計算 r = x₁ mod n（2 分）  
c) 計算 k⁻¹ mod 19（5 分）  
d) 計算 s = k⁻¹(z + r·d) mod 19（10 分）

**答案空間：**
```
[請在此處填寫您的答案]

























```

---

## 第四部分：驗證流程（25 分）

### 5. 完整驗證計算

**使用上題的結果驗證簽章**

**給定：**
```
曲線：y² ≡ x³ + 2x + 2 (mod 17)
基準點 G = (5, 1)
階數 n = 19
公鑰 Q = 4G（上題計算）
訊息雜湊 z = 7
簽章 (r, s)（上題結果）
```

**問題：**
a) 計算 w = s⁻¹ mod 19（5 分）  
b) 計算 u₁ = z·w mod 19（3 分）  
c) 計算 u₂ = r·w mod 19（3 分）  
d) 說明如何驗證簽章（不需要完整計算驗證點）（14 分）

**答案空間：**
```
[請在此處填寫您的答案]























```

---

## 📊 評分標準

### 總分評級
- **90-100 分：優秀**  
  完全掌握手算技巧，計算準確，可以獨立完成所有 ECDSA 計算
  
- **70-89 分：良好**  
  基本掌握計算方法，有小錯誤，建議多練習以提高準確度
  
- **60-69 分：及格**  
  理解流程但計算不夠熟練，需要加強模運算和點運算的練習
  
- **60 分以下：需要加強**  
  建議重新學習模組五，特別是點加法和模反元素的計算

---

# 📘 測驗解答

## 第一部分：基礎計算解答

### 1. 模反元素計算

**a) 3⁻¹ mod 17（3分）**

需要找到 x 使得 3x ≡ 1 (mod 17)

**方法 1：嘗試法**
```
3×1 = 3 ≢ 1 (mod 17)
3×2 = 6 ≢ 1 (mod 17)
3×3 = 9 ≢ 1 (mod 17)
3×4 = 12 ≢ 1 (mod 17)
3×5 = 15 ≢ 1 (mod 17)
3×6 = 18 = 17 + 1 ≡ 1 (mod 17) ✓
```

**方法 2：擴展歐幾里得算法**
```
17 = 5×3 + 2
3 = 1×2 + 1
2 = 2×1 + 0

回代：
1 = 3 - 1×2
1 = 3 - 1×(17 - 5×3)
1 = 3 - 17 + 5×3
1 = 6×3 - 17

所以：6×3 ≡ 1 (mod 17)
```

驗證：3 × 6 = 18 ≡ 1 (mod 17) ✓

**答案：3⁻¹ = 6 mod 17**

---

**b) 7⁻¹ mod 19（3分）**

需要找到 x 使得 7x ≡ 1 (mod 19)

**使用擴展歐幾里得算法：**
```
19 = 2×7 + 5
7 = 1×5 + 2
5 = 2×2 + 1
2 = 2×1 + 0

回代：
1 = 5 - 2×2
1 = 5 - 2×(7 - 1×5)
1 = 5 - 2×7 + 2×5
1 = 3×5 - 2×7
1 = 3×(19 - 2×7) - 2×7
1 = 3×19 - 6×7 - 2×7
1 = 3×19 - 8×7

所以：-8×7 ≡ 1 (mod 19)
      11×7 ≡ 1 (mod 19)  [因為 -8 ≡ 11 (mod 19)]
```

驗證：7 × 11 = 77 = 4×19 + 1 ≡ 1 (mod 19) ✓

**答案：7⁻¹ = 11 mod 19**

---

**c) 15⁻¹ mod 17（4分）**

需要找到 x 使得 15x ≡ 1 (mod 17)

**使用擴展歐幾里得算法：**
```
17 = 1×15 + 2
15 = 7×2 + 1
2 = 2×1 + 0

回代：
1 = 15 - 7×2
1 = 15 - 7×(17 - 1×15)
1 = 15 - 7×17 + 7×15
1 = 8×15 - 7×17

所以：8×15 ≡ 1 (mod 17)
```

驗證：15 × 8 = 120 = 7×17 + 1 ≡ 1 (mod 17) ✓

**答案：15⁻¹ = 8 mod 17**

---

**評分標準（10分）：**
- a) 正確答案（3分）：完全正確3分，計算過程對但答案錯1分
- b) 正確答案（3分）：完全正確3分，計算過程對但答案錯1分  
- c) 正確答案（4分）：完全正確4分，計算過程對但答案錯2分

---

### 2. 點加法計算

**給定曲線：** y² ≡ x³ + 2x + 2 (mod 17)

**a) P + Q，其中 P = (5, 1), Q = (6, 3)（10分）**

**步驟 1：計算斜率**
```
λ = (y₂ - y₁) / (x₂ - x₁) mod p
  = (3 - 1) / (6 - 5) mod 17
  = 2 / 1 mod 17
  = 2
```

**步驟 2：計算 x₃**
```
x₃ = λ² - x₁ - x₂ mod p
   = 2² - 5 - 6 mod 17
   = 4 - 11 mod 17
   = -7 mod 17
   = 10
```

**步驟 3：計算 y₃**
```
y₃ = λ(x₁ - x₃) - y₁ mod p
   = 2(5 - 10) - 1 mod 17
   = 2×(-5) - 1 mod 17
   = -10 - 1 mod 17
   = -11 mod 17
   = 6
```

**驗證：**
```
(10, 6) 是否在曲線上？
y² = 36 ≡ 2 (mod 17)
x³ + 2x + 2 = 1000 + 20 + 2 = 1022 ≡ 2 (mod 17) ✓
```

**答案：P + Q = (10, 6)**

---

**b) 2P，其中 P = (10, 6)（10分）**

**步驟 1：計算斜率**
```
λ = (3x₁² + a) / (2y₁) mod p

其中 a = 2

分子：3×10² + 2 = 3×100 + 2 = 302
     302 mod 17 = 302 - 17×17 = 302 - 289 = 13

分母：2×6 = 12

λ = 13 / 12 mod 17
```

**求 12⁻¹ mod 17：**
```
17 = 1×12 + 5
12 = 2×5 + 2
5 = 2×2 + 1
2 = 2×1 + 0

回代：
1 = 5 - 2×2
1 = 5 - 2×(12 - 2×5)
1 = 5×5 - 2×12
1 = 5×(17 - 12) - 2×12
1 = 5×17 - 7×12

所以：-7×12 ≡ 1 (mod 17)
      10×12 ≡ 1 (mod 17)

12⁻¹ = 10 mod 17
```

**繼續計算斜率：**
```
λ = 13 × 10 mod 17
  = 130 mod 17
  = 130 - 7×17
  = 11
```

**步驟 2：計算 x₃**
```
x₃ = λ² - 2x₁ mod p
   = 11² - 2×10 mod 17
   = 121 - 20 mod 17
   = 101 mod 17
   = 101 - 5×17
   = 16
```

**步驟 3：計算 y₃**
```
y₃ = λ(x₁ - x₃) - y₁ mod p
   = 11(10 - 16) - 6 mod 17
   = 11×(-6) - 6 mod 17
   = -66 - 6 mod 17
   = -72 mod 17
   = -72 + 5×17
   = 13
```

**驗證：**
```
(16, 13) 是否在曲線上？
y² = 169 ≡ 16 (mod 17)
x³ + 2x + 2 = 4096 + 32 + 2 = 4130 ≡ 16 (mod 17) ✓
```

**答案：2P = (16, 13)**

---

**評分標準（20分）：**

**a) P + Q（10分）：**
- 正確計算斜率（3分）
- 正確計算 x₃（3分）
- 正確計算 y₃（3分）
- 驗證點在曲線上（1分）

**b) 2P（10分）：**
- 正確計算斜率（含模反元素）（4分）
- 正確計算 x₃（2分）
- 正確計算 y₃（3分）
- 驗證點在曲線上（1分）

---

## 第二部分：公鑰生成解答

### 3. 公鑰計算

**給定：**
- 曲線：y² ≡ x³ + 2x + 2 (mod 17)
- G = (5, 1)
- d = 4

**求：Q = 4G**

**策略：4G = 2G + 2G**

**步驟 1：計算 2G**

```
P = G = (5, 1)

λ = (3×5² + 2) / (2×1) mod 17
  = 77 / 2 mod 17

77 mod 17 = 9
2⁻¹ = 9 mod 17（之前計算過）

λ = 9 × 9 = 81 ≡ 13 (mod 17)

x₃ = 13² - 2×5 mod 17
   = 169 - 10 mod 17
   = 159 mod 17
   = 6

y₃ = 13(5 - 6) - 1 mod 17
   = -13 - 1 mod 17
   = 3

2G = (6, 3)
```

**步驟 2：計算 4G = 2G + 2G**

```
P = 2G = (6, 3)

λ = (3×6² + 2) / (2×3) mod 17
  = (108 + 2) / 6 mod 17
  = 110 / 6 mod 17

110 mod 17 = 8
6⁻¹ = 3 mod 17（之前計算過）

λ = 8 × 3 = 24 ≡ 7 (mod 17)

x₃ = 7² - 2×6 mod 17
   = 49 - 12 mod 17
   = 37 mod 17
   = 3

y₃ = 7(6 - 3) - 3 mod 17
   = 21 - 3 mod 17
   = 18 mod 17
   = 1

4G = (3, 1)
```

**驗證：**
```
(3, 1) 是否在曲線上？
y² = 1
x³ + 2x + 2 = 27 + 6 + 2 = 35 ≡ 1 (mod 17) ✓
```

**答案：Q = 4G = (3, 1)**

---

**評分標準（20分）：**
- 正確計算 2G（8分）
  - 斜率計算（3分）
  - x, y 座標計算（5分）
- 正確計算 4G（10分）
  - 斜率計算（4分）
  - x, y 座標計算（5分）
  - 驗證（1分）
- 最終答案（2分）

---

## 第三部分：簽署流程解答

### 4. 完整簽署計算

**給定：**
- d = 4, z = 7, k = 3, n = 19

**a) 計算 3G（8分）**

```
策略：3G = 2G + G

使用之前的結果：
G = (5, 1)
2G = (6, 3)

計算 3G = 2G + G：
P = (6, 3), Q = (5, 1)

λ = (1 - 3) / (5 - 6) mod 17
  = -2 / -1 mod 17
  = 2

x₃ = 2² - 6 - 5 mod 17
   = -7 mod 17
   = 10

y₃ = 2(6 - 10) - 3 mod 17
   = -8 - 3 mod 17
   = -11 mod 17
   = 6

3G = (10, 6)
```

**答案：3G = (10, 6)**

---

**b) 計算 r（2分）**

```
簽章點 = 3G = (10, 6)
x₁ = 10

r = x₁ mod n
  = 10 mod 19
  = 10
```

**答案：r = 10**

---

**c) 計算 k⁻¹ mod 19（5分）**

```
k = 3, n = 19
需要找到 3⁻¹ mod 19

使用擴展歐幾里得算法：
19 = 6×3 + 1
3 = 3×1 + 0

回代：
1 = 19 - 6×3

所以：-6×3 ≡ 1 (mod 19)
      13×3 ≡ 1 (mod 19)  [因為 -6 ≡ 13 (mod 19)]

驗證：3 × 13 = 39 = 2×19 + 1 ≡ 1 (mod 19) ✓
```

**答案：k⁻¹ = 13 mod 19**

---

**d) 計算 s（10分）**

```
s = k⁻¹(z + r·d) mod n

計算 z + r·d：
z + r·d = 7 + 10×4
        = 7 + 40
        = 47

47 mod 19 = 47 - 2×19 = 47 - 38 = 9

計算 s：
s = k⁻¹ × (z + r·d) mod n
  = 13 × 9 mod 19
  = 117 mod 19
  = 117 - 6×19
  = 117 - 114
  = 3
```

**驗證：**
```
r = 10 ≠ 0 ✓
s = 3 ≠ 0 ✓
```

**答案：s = 3**

**最終簽章：(r, s) = (10, 3)**

---

**評分標準（25分）：**
- a) 計算 3G（8分）
  - 選擇正確策略（1分）
  - 計算斜率（2分）
  - 計算座標（5分）
- b) 計算 r（2分）
- c) 計算 k⁻¹（5分）
  - 正確使用算法（3分）
  - 驗證（1分）
  - 正確答案（1分）
- d) 計算 s（10分）
  - 計算 z + r·d（3分）
  - 計算 s（5分）
  - 驗證 r, s 非零（2分）

---

## 第四部分：驗證流程解答

### 5. 完整驗證計算

**使用的參數：**
- Q = 4G = (3, 1)
- z = 7
- (r, s) = (10, 3)

**a) 計算 w = s⁻¹ mod 19（5分）**

```
s = 3, n = 19
需要找到 3⁻¹ mod 19

從之前的計算（第三部分 c），我們知道：
3⁻¹ = 13 mod 19

驗證：3 × 13 = 39 ≡ 1 (mod 19) ✓
```

**答案：w = 13**

---

**b) 計算 u₁ = z·w mod 19（3分）**

```
u₁ = z · w mod n
   = 7 × 13 mod 19
   = 91 mod 19
   = 91 - 4×19
   = 91 - 76
   = 15
```

**答案：u₁ = 15**

---

**c) 計算 u₂ = r·w mod 19（3分）**

```
u₂ = r · w mod n
   = 10 × 13 mod 19
   = 130 mod 19
   = 130 - 6×19
   = 130 - 114
   = 16
```

**答案：u₂ = 16**

---

**d) 說明如何驗證簽章（14分）**

**驗證步驟說明：**

```
步驟 1：計算驗證點
需要計算：P = u₁×G + u₂×Q = 15G + 16Q

其中：
- G = (5, 1)
- Q = (3, 1)

步驟 2：提取 x 座標
設驗證點 P = (x₁, y₁)

步驟 3：比較
檢查：r ≡ x₁ mod n
即：10 ≡ x₁ mod 19

如果相等，簽章有效
如果不等，簽章無效
```

**數學原理：**

```
為什麼這個驗證有效？

驗證點 = u₁×G + u₂×Q
       = (z·w)×G + (r·w)×Q
       = w(z×G + r×Q)
       = s⁻¹(z×G + r×d×G)    [因為 Q = d×G]
       = s⁻¹(z + r×d)×G

從簽署過程：
s = k⁻¹(z + r×d) mod n

因此：
s⁻¹ = k / (z + r×d) mod n

驗證點 = [k / (z + r×d)] × (z + r×d) × G
       = k × G

而簽署時的簽章點 = k × G

所以驗證點 = 簽章點

它們的 x 座標相同，即 x₁ = r
```

**實際計算（供參考）：**

```
如果完整計算 15G + 16Q：

使用模組五的方法：
15 = 8 + 4 + 2 + 1
16 = 8 + 8

需要計算各個倍數點然後相加

最終會得到驗證點的 x 座標 = 10
而 r = 10

所以 r ≡ x₁ mod 19 ✓

簽章有效！
```

**總結：**
```
✓ 簽章 (10, 3) 是有效的
✓ 它確實是由私鑰 d = 4 的擁有者簽署的
✓ 訊息雜湊 z = 7 沒有被篡改
```

---

**評分標準（25分）：**
- a) 計算 w（5分）
  - 正確找到或引用 s⁻¹（4分）
  - 驗證（1分）
- b) 計算 u₁（3分）
- c) 計算 u₂（3分）
- d) 驗證說明（14分）
  - 說明需要計算的驗證點（3分）
  - 說明比較方法（3分）
  - 解釋數學原理（6分）
  - 結論（2分）

---

## 🎓 測驗總結

### 學習重點回顧

完成這個測驗後，你應該能夠：

**計算技能：**
```
✓ 熟練計算模反元素
✓ 正確進行點加法和點加倍
✓ 完成完整的公鑰生成
✓ 完成完整的簽署流程
✓ 理解驗證流程的每個步驟
```

**理解深度：**
```
✓ 理解每個公式的數學意義
✓ 知道何時使用 mod p vs mod n
✓ 理解簽署和驗證的數學關聯
✓ 能夠驗證中間結果的正確性
```

**除錯能力：**
```
✓ 識別計算中的錯誤
✓ 驗證點是否在曲線上
✓ 檢查結果的合理性
```

### 常見錯誤回顧

**錯誤 1：符號處理**
```
✗ -7 mod 17 = -7
✓ -7 mod 17 = 10

記住：負數結果要加 p 直到為正
```

**錯誤 2：公式混淆**
```
P + P：用點加倍公式
      λ = (3x² + a) / (2y)

P + Q：用點加法公式（P ≠ Q）
      λ = (y₂ - y₁) / (x₂ - x₁)
```

**錯誤 3：模數混淆**
```
點座標運算：mod p = 17
標量運算：mod n = 19

不要混淆！
```

### 下一步建議

**如果得分 70 分以上：**
✓ 恭喜！你已經掌握了 ECDSA 的手算
✓ 可以繼續學習[模組六：習題練習](../module6-practice-exercises/)
✓ 建議嘗試用程式實現這些計算

**如果得分 60-69 分：**
→ 基本掌握了，但需要更多練習
→ 建議：
  1. 重做錯誤的題目
  2. 多練習模反元素計算
  3. 多練習點運算
  4. 驗證每個中間結果

**如果得分 60 分以下：**
→ 需要重新學習模組五
→ 建議：
  1. 仔細閱讀每個詳細步驟
  2. 用計算器輔助，但理解過程
  3. 從最簡單的例子開始
  4. 向老師或同學請教

### 實踐建議

1. **繼續練習**
   - 每天做1-2道計算題
   - 使用不同的參數
   - 計時，提高速度

2. **程式實現**
   - 用 Python 實現這些計算
   - 對比手算和程式結果
   - 理解算法實現

3. **深化理解**
   - 研究為什麼公式有效
   - 探索其他橢圓曲線
   - 了解優化技巧

---

**繼續努力！手算是理解密碼學的最佳方式！** 🚀

